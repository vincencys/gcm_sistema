<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Verificação de Relatório - Livro CECOM</title>
  <style>
    :root{--ok:#2e7d32;--err:#c62828;--muted:#666}
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;margin:0;background:#f7f7f7;color:#222}
    .wrap{max-width:760px;margin:0 auto;padding:24px}
    .card{background:#fff;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,.06);padding:20px}
    h1{font-size:20px;margin:0 0 8px}
    .status{display:inline-block;padding:6px 10px;border-radius:999px;font-weight:600;font-size:13px}
    .ok{background:#e8f5e9;color:var(--ok);border:1px solid #c8e6c9}
    .err{background:#ffebee;color:var(--err);border:1px solid #ffcdd2}
    .grid{display:grid;grid-template-columns:120px 1fr;gap:8px 14px;margin-top:14px;align-items:start}
    .label{color:#555;font-size:12px;text-transform:uppercase;letter-spacing:.04em}
    .value{font-weight:500;min-width:0}
    .token{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;background:#f0f0f0;border:1px solid #e3e3e3;border-radius:6px;padding:6px 10px;display:inline-block;max-width:100%;word-break:break-all;overflow-wrap:anywhere;white-space:normal}
    .copy{margin-left:8px;border:1px solid #e0e0e0;background:#fafafa;border-radius:6px;padding:6px 10px;font-size:12px;color:#333}
    .copy:active{transform:scale(.98)}
    .muted{color:var(--muted)}
    footer{margin-top:22px;font-size:12px;color:#777}
    @media (max-width: 480px){
      .grid{grid-template-columns:1fr}
      .label{margin-top:8px}
      .value{margin-top:-2px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Verificação do Relatório do Livro CECOM</h1>
      {% if status == 'OK' %}
        <div class="status ok">Status: OK</div>
        <div class="grid">
          <div class="label">Token</div>
          <div class="value"><span class="token" id="tokenText">{{ token }}</span><button class="copy" type="button" data-copy="#tokenText">Copiar</button></div>
          <div class="label">Relatório</div>
          <div class="value">Plantão #{{ plantao_id }}</div>
          <div class="label">Gerado em</div>
          <div class="value">{{ criado_em|date:'d/m/Y H:i' }}</div>
          <div class="label">Operador</div>
          <div class="value">{{ operador_nome }}{% if operador_matricula %} <span class="muted">(Matrícula {{ operador_matricula }})</span>{% endif %}</div>
        </div>
        <footer>
          Este código confirma a autenticidade do documento assinado. Guarde este comprovante para futuras conferências.
        </footer>
      {% else %}
        <div class="status err">Status: NÃO ENCONTRADO</div>
        <p>Não foi possível localizar um relatório com o token informado.</p>
        <div class="grid">
          <div class="label">Token</div>
          <div class="value"><span class="token">{{ token }}</span></div>
        </div>
      {% endif %}
    </div>
  </div>
  <script>
    (function(){
      var btn = document.querySelector('.copy');
      if(!btn) return;
      btn.addEventListener('click', function(){
        var sel = btn.getAttribute('data-copy');
        var el = document.querySelector(sel);
        if(!el) return;
        var text = el.textContent.trim();
        if(navigator.clipboard && navigator.clipboard.writeText){
          navigator.clipboard.writeText(text).then(function(){
            btn.textContent = 'Copiado';
            setTimeout(function(){ btn.textContent = 'Copiar'; }, 1500);
          });
        }
      });
    })();
  </script>
</body>
</html>
