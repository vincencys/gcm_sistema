{% extends "_layout/base.html" %}
{% block title %}Nova senha{% endblock %}
{% block content %}
<div class="max-w-lg mx-auto bg-white rounded-lg shadow p-6">
  <h1 class="text-xl font-semibold mb-2">Definir nova senha</h1>
  {% if validlink %}
    <form method="post" class="space-y-4">{% csrf_token %}
      {% if form.non_field_errors %}
        <div class="text-red-600 text-sm">{{ form.non_field_errors }}</div>
      {% endif %}
      <div>
        <label class="block text-sm font-medium mb-1">Nova senha</label>
        {{ form.new_password1 }}
        {% if form.new_password1.errors %}
          <div class="text-red-600 text-xs mt-1">{{ form.new_password1.errors }}</div>
        {% endif %}
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">Confirmar nova senha</label>
        {{ form.new_password2 }}
        {% if form.new_password2.errors %}
          <div class="text-red-600 text-xs mt-1">{{ form.new_password2.errors }}</div>
        {% endif %}
      </div>
      <button type="submit" class="btn btn-primary">Salvar nova senha</button>
    </form>
  {% else %}
    <p class="text-sm text-red-600">Este link de redefinição não é válido ou expirou. Solicite um novo.</p>
  {% endif %}
</div>
<script>
  // Aplica classes de contorno/estilo aos campos de senha renderizados pelo Django
  document.addEventListener('DOMContentLoaded', function(){
    const a = document.getElementById('id_new_password1');
    const b = document.getElementById('id_new_password2');
    [a,b].forEach(function(el, i){
      if(!el) return;
      el.classList.add('w-full','border','rounded','px-3','py-2','focus:outline-none','focus:ring-2','focus:ring-sky-400');
      if(i===0 && !el.placeholder) el.placeholder = 'Nova senha';
      if(i===1 && !el.placeholder) el.placeholder = 'Confirmar nova senha';
    });
  });
  </script>
{% endblock %}
