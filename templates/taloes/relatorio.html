
<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <title>Relatório de Ronda — Talão {{ talao.id }}</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; font-size: 12px; }
    h1,h2 { margin: .2rem 0; }
    table { width: 100%; border-collapse: collapse; margin-top: .5rem; }
    th, td { border: 1px solid #ddd; padding: .35rem; }
    th { background: #f5f5f5; }
  </style>
</head>
<body>
  <h1>Relatório de Ronda</h1>
  <p><b>Viatura:</b> {{ talao.viatura.prefixo }} • <b>Equipe:</b> {{ talao.equipe }}
     • <b>Encarregado:</b> {{ talao.encarregado.get_full_name|default:talao.encarregado.username }}</p>
  <p><b>Início:</b> {{ talao.inicio|date:"d/m/Y H:i" }} •
     <b>Fim:</b> {{ talao.fim|date:"d/m/Y H:i"|default:"—" }} •
     <b>KM:</b> {{ talao.km_inicio|default:"—" }} → {{ talao.km_fim|default:"—" }}</p>

  <h2>Atividades</h2>
  <table>
    <thead>
      <tr><th>Data/Hora</th><th>Código</th><th>KM</th><th>Bairro</th><th>Local</th><th>Obs.</th></tr>
    </thead>
    <tbody>
      {% for a in atividades %}
      <tr>
        <td>{{ a.momento|date:"d/m/Y H:i" }}</td>
        <td>{{ a.codigo.codigo }} — {{ a.codigo.descricao }}</td>
        <td style="text-align:right">{{ a.km }}</td>
        <td>{{ a.bairro }}</td>
        <td>{{ a.local }}</td>
        <td>{{ a.observacao }}</td>
      </tr>
      {% empty %}
      <tr><td colspan="6">Sem atividades.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <h2>Relatório do Encarregado</h2>
  <pre style="white-space: pre-wrap">{{ talao.relatorio_encarregado }}</pre>
</body>
</html>

