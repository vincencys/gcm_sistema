{% extends "base.html" %}
{% block title %}Lista de Equipes de Apoio{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto bg-white rounded-xl shadow-lg p-4 sm:p-6">
    <div class="flex items-center justify-between mb-6 flex-col gap-3 sm:flex-row sm:gap-0">
        <h2 class="text-2xl font-bold text-indigo-800">üìã Lista de Equipes de Apoio</h2>
        <div class="flex gap-3 w-full sm:w-auto">
            <a href="{% url 'bogcmi:equipe_form' %}" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-semibold transition-colors w-full sm:w-auto text-center">
                ‚ûï Nova Equipe
            </a>
            <a href="{% url 'bogcmi:novo' %}" class="px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-semibold transition-colors w-full sm:w-auto text-center">
                ‚Ü©Ô∏è Voltar
            </a>
        </div>
    </div>

    {% if equipes %}
        {# Mobile: cards #}
        <div class="md:hidden space-y-3">
            {% for equipe in equipes %}
            <div class="bg-white border rounded-xl p-3 shadow-sm">
                <div class="flex items-start justify-between gap-3">
                    <div class="min-w-0">
                        <div class="text-xs text-slate-500">Equipe #{{ equipe.id }}</div>
                        <div class="mt-1 font-semibold">Viatura {{ equipe.viatura.prefixo }}</div>
                        <div class="text-xs text-slate-600 mt-0.5">Institui√ß√£o: {{ equipe.instituicao }}</div>
                    </div>
                </div>
                <div class="mt-2 space-y-1 text-sm break-words">
                    <div>
                        <span class="text-slate-500">Participantes:</span>
                        {% if equipe.participantes %}
                          <div class="mt-1 bg-green-50 text-green-800 px-2 py-1 rounded text-xs leading-relaxed">{{ equipe.participantes|linebreaksbr }}</div>
                        {% else %}
                          <span class="text-slate-400">Nenhum participante informado</span>
                        {% endif %}
                    </div>
                    <div class="mt-1">
                        <span class="text-slate-500">Observa√ß√µes:</span>
                        {% if equipe.observacoes %}
                          <div class="mt-1 text-sm">{{ equipe.observacoes }}</div>
                        {% else %}
                          <span class="text-slate-400">-</span>
                        {% endif %}
                    </div>
                </div>
                <div class="mt-3 grid grid-cols-2 gap-2">
                    <a href="{% url 'bogcmi:equipe_editar' equipe.id %}" class="inline-flex items-center justify-center h-9 px-3 border rounded bg-blue-50 text-blue-700 hover:bg-blue-100">Editar</a>
                    <a href="{% url 'bogcmi:equipe_excluir' equipe.id %}" onclick="return confirm('Tem certeza que deseja excluir esta equipe de apoio?')" class="inline-flex items-center justify-center h-9 px-3 border rounded bg-rose-50 text-rose-700 hover:bg-rose-100">Excluir</a>
                </div>
            </div>
            {% endfor %}
        </div>

        {# Desktop: tabela #}
        <div class="hidden md:block overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                <thead class="bg-indigo-50">
                    <tr>
                        <th class="px-4 py-3 text-left text-sm font-semibold text-indigo-800 border-b">ID</th>
                        <th class="px-4 py-3 text-left text-sm font-semibold text-indigo-800 border-b">Viatura</th>
                        <th class="px-4 py-3 text-left text-sm font-semibold text-indigo-800 border-b">Institui√ß√£o</th>
                        <th class="px-4 py-3 text-left text-sm font-semibold text-indigo-800 border-b">Participantes</th>
                        <th class="px-4 py-3 text-left text-sm font-semibold text-indigo-800 border-b">Observa√ß√µes</th>
                        <th class="px-4 py-3 text-center text-sm font-semibold text-indigo-800 border-b">A√ß√µes</th>
                    </tr>
                </thead>
                <tbody>
                    {% for equipe in equipes %}
                        <tr class="hover:bg-gray-50 transition-colors">
                            <td class="px-4 py-3 text-sm text-gray-800 border-b">{{ equipe.id }}</td>
                            <td class="px-4 py-3 text-sm text-gray-800 border-b">
                                <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-semibold">
                                    {{ equipe.viatura.prefixo }}
                                </span>
                            </td>
                            <td class="px-4 py-3 text-sm text-gray-800 border-b">{{ equipe.instituicao }}</td>
                            <td class="px-4 py-3 text-sm text-gray-800 border-b">
                                {% if equipe.participantes %}
                                    <div class="max-w-xs">
                                        <div class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs leading-relaxed">
                                            {{ equipe.participantes|linebreaksbr }}
                                        </div>
                                    </div>
                                {% else %}
                                    <span class="text-gray-400 italic">Nenhum participante informado</span>
                                {% endif %}
                            </td>
                            <td class="px-4 py-3 text-sm text-gray-800 border-b">
                                {% if equipe.observacoes %}
                                    <div class="max-w-xs truncate" title="{{ equipe.observacoes }}">
                                        {{ equipe.observacoes }}
                                    </div>
                                {% else %}
                                    <span class="text-gray-400 italic">-</span>
                                {% endif %}
                            </td>
                            <td class="px-4 py-3 text-center border-b">
                                <div class="flex justify-center gap-2 flex-wrap">
                                    <a href="{% url 'bogcmi:equipe_editar' equipe.id %}" 
                                       class="px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded text-xs font-semibold transition-colors w-full sm:w-auto">
                                        ‚úèÔ∏è Editar
                                    </a>
                                    <a href="{% url 'bogcmi:equipe_excluir' equipe.id %}" 
                                       class="px-3 py-1 bg-red-500 hover:bg-red-600 text-white rounded text-xs font-semibold transition-colors w-full sm:w-auto"
                                       onclick="return confirm('Tem certeza que deseja excluir esta equipe de apoio?')">
                                        üóëÔ∏è Excluir
                                    </a>
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <div class="text-center py-16">
            <div class="text-gray-400 text-6xl mb-4">üìã</div>
            <h3 class="text-xl font-semibold text-gray-600 mb-2">Nenhuma equipe de apoio cadastrada</h3>
            <p class="text-gray-500 mb-6">Registre equipes de apoio de diferentes institui√ß√µes (GCM, PM, Pol√≠cia Civil, etc.).</p>
            <a href="{% url 'bogcmi:equipe_form' %}" class="px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-semibold transition-colors inline-block w-full sm:w-auto">
                ‚ûï Adicionar Primeira Equipe
            </a>
        </div>
    {% endif %}
</div>

<style>
.truncate {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.table-hover tr:hover {
    background-color: #f9fafb;
}
</style>
{% endblock %}