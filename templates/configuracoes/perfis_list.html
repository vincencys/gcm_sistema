{% extends "_layout/base.html" %}
{% block title %}Perfis GCM{% endblock %}
{% block content %}
<div class="mb-4">
  <nav class="text-sm text-slate-600 mb-2">
    <a href="{% url 'core:dashboard' %}" class="hover:text-slate-900">Início</a>
    <span class="mx-2">›</span>
    <a href="{% url 'core:config_dashboard' %}" class="hover:text-slate-900">Configurações</a>
    <span class="mx-2">›</span>
    <span class="text-slate-900">Perfis GCM</span>
  </nav>
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-2xl font-bold text-slate-900">Gestão de Perfis GCM</h1>
      <p class="text-slate-600 mt-1">Visualizar e editar perfis dos guardas</p>
    </div>
    <a href="{% url 'core:config_perfil_novo' %}" class="inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors shadow-sm">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
      Novo Perfil
    </a>
  </div>
</div>

<div class="bg-white rounded-xl shadow-sm border border-slate-200 mb-4 p-4">
  <form method="get">
    <div class="relative">
      <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
      <input type="text" name="q" value="{{ q }}" placeholder="Buscar por usuário, matrícula ou nome..." class="w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" />
    </div>
  </form>
</div>
<div class="overflow-x-auto bg-white border rounded-xl shadow-sm">
  <table class="min-w-full text-sm">
    <thead class="bg-slate-50 border-b">
      <tr class="text-left">
        <th class="p-2">Usuário</th>
        <th class="p-2">Matrícula</th>
        <th class="p-2">Equipe</th>
        <th class="p-2">Classe</th>
        <th class="p-2">Ativo</th>
        <th class="p-2">Ações</th>
      </tr>
    </thead>
    <tbody>
      {% for p in perfis %}
      <tr class="border-b">
        <td class="p-2">{{ p.user.username }} — {{ p.user.first_name }} {{ p.user.last_name }}</td>
        <td class="p-2">{{ p.matricula|default:'—' }}</td>
        <td class="p-2">{{ p.equipe|default:'—' }}</td>
        <td class="p-2">{{ p.classe_legivel|default:'—' }}</td>
        <td class="p-2">{% if p.ativo %}<span class="text-green-700">Sim</span>{% else %}<span class="text-slate-500">Não</span>{% endif %}</td>
        <td class="p-2">
          <a href="{% url 'core:config_perfil_editar' perfil_id=p.id %}" class="inline-flex items-center h-8 px-2 py-1 border rounded hover:bg-blue-50">Editar</a>
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="6" class="p-3 text-center text-slate-500">Nenhum perfil encontrado.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
<div class="mt-3 flex justify-center">{% include "_partials/pagination.html" with page_obj=perfis %}</div>
{% endblock %}
