{% extends '_layout/base.html' %}
{% load core_extras %}
{% block title %}AudiÃªncias{% endblock %}
{% block content %}
<!-- Header -->
<div class="mb-6 bg-white border border-slate-200 rounded-lg shadow-sm overflow-hidden">
  <div class="px-4 py-3 flex items-center justify-between" style="background:#f1f5f9;border-bottom:1px solid #e5e7eb;">
    <div class="flex items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h6l4 4v14z"/></svg>
      <h1 class="text-xl font-bold text-slate-800">AudiÃªncias</h1>
    </div>
  </div>
</div>

<div class="bg-white border rounded p-4 max-w-xl">
  {% if doc %}
    <div class="space-y-3">
      <div class="aspect-video bg-slate-100 rounded overflow-hidden flex items-center justify-center">
        {% if doc.arquivo.url|is_image %}
          <img src="{{ doc.arquivo.url }}" alt="AudiÃªncias" class="max-h-64 object-contain"/>
        {% elif doc.arquivo.url|is_pdf %}
          <a href="{{ doc.arquivo.url }}" target="_blank" class="flex items-center gap-2 text-slate-700">
            <span>ðŸ“„</span> <span>PDF</span>
          </a>
        {% else %}
          <a href="{{ doc.arquivo.url }}" target="_blank" class="text-slate-700 underline">Abrir arquivo</a>
        {% endif %}
      </div>
      <div class="text-xs text-slate-500">Atualizado em {{ doc.updated_at|date:"d/m/Y H:i" }}</div>
      <div class="flex gap-2">
        <a href="{{ doc.arquivo.url }}" target="_blank" class="px-3 py-1 rounded bg-indigo-600 text-white text-sm">Abrir</a>
        {% if can_manage %}
          <form action="{% url 'core:audiencias_remover' %}" method="post" onsubmit="return confirm('Remover arquivo de AudiÃªncias?');">
            {% csrf_token %}
            <button type="submit" class="px-3 py-1 rounded bg-rose-600 text-white text-sm">Remover</button>
          </form>
        {% endif %}
      </div>
    </div>
  {% else %}
    <p class="text-sm text-slate-600">Nenhum arquivo enviado.</p>
  {% endif %}

  {% if can_manage %}
  <hr class="my-4"/>
  <form action="{% url 'core:audiencias_upload' %}" method="post" enctype="multipart/form-data" class="space-y-2">
    {% csrf_token %}
    <input type="file" name="arquivo" accept="image/*,.pdf" class="block w-full text-sm" required />
    <button type="submit" class="px-3 py-1 rounded bg-emerald-600 text-white text-sm">Inserir anexo</button>
  </form>
  {% endif %}
</div>
{% endblock %}
